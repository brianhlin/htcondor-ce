
###############################################################################
#
# HTCondor-CE health monitoring configuration
#
# DO NOT EDIT THIS FILE!  It will be overwritten upon RPM upgrade.
# If you wish to make changes to the HTCondor-CE configuration, create files
# in /etc/condor-ce/config.d containing your changes.
#
###############################################################################


# Default thresholds for daemon statistics
DUTY_CYCLE_WARNING = .90
DUTY_CYCLE_CRITICAL = .95
FILE_XFER_LOAD_WARNING = 1.0
FILE_XFER_LOAD_CRITICAL = 2.0

# Definition of health metrics
IsOK = !IsWarning && !IsCritical

IsWarning =            \
                       (RecentDaemonCoreDutyCycle > $(DUTY_CYCLE_WARNING)) || \
                       (FileTransferFileReadLoad_5m > $(FILE_XFER_LOAD_WARNING)) || \
                       (FileTransferFileWriteLoad_1m > $(FILE_XFER_LOAD_WARNING))

IsCritical =           \
                       (RecentDaemonCoreDutyCycle > $(DUTY_CYCLE_CRITICAL)) || \
                       (FileTransferFileReadLoad_5m > $(FILE_XFER_LOAD_CRITICAL)) || \
                       (FileTransferFileWriteLoad_1m > $(FILE_XFER_LOAD_CRITICAL))

# Definition of overall status
Status = ifThenElse(IsOK, "OK", \
           ifThenElse(IsCritical, "CRITICAL", \
             ifThenElse(IsWarning, "WARNING", \
               "UNKNOWN" \
             ) \
           ) \
         )

SCHEDD_ATTRS = $(SCHEDD_ATTRS), IsOK, IsWarning, IsCritical, Status

